# å›¾ç‰‡ç®¡ç†ç³»ç»Ÿ

ä¸€ä¸ªåŠŸèƒ½å¼ºå¤§çš„åŸºäº Next.js 14 çš„å…¨æ ˆå›¾ç‰‡ç®¡ç†ç³»ç»Ÿï¼Œæ”¯æŒ AI æ™ºèƒ½é—®ç­”ã€åœ°å›¾è§†å›¾ã€å›¾ç‰‡ç¼–è¾‘ç­‰åŠŸèƒ½ã€‚

## âœ¨ ä¸»è¦åŠŸèƒ½ç‰¹æ€§

### ğŸ–¼ï¸ æ ¸å¿ƒåŠŸèƒ½
- **å›¾ç‰‡ä¸Šä¼ ä¸ç®¡ç†** - æ”¯æŒæ‹–æ‹½ä¸Šä¼ ï¼Œè‡ªåŠ¨ç”Ÿæˆç¼©ç•¥å›¾ï¼Œä¿ç•™ EXIF æ•°æ®
- **å›¾ç‰‡ç”»å»Š** - å“åº”å¼ç½‘æ ¼å±•ç¤ºï¼Œæ”¯æŒåˆ†é¡µå’Œæ— é™æ»šåŠ¨
- **æ™ºèƒ½æœç´¢** - æ”¯æŒæŒ‰æ ‡ç­¾ã€æ—¶é—´ã€ä½ç½®ç­‰å¤šç»´åº¦æœç´¢
- **å›¾ç‰‡ç¼–è¾‘** - è£å‰ªã€æ»¤é•œã€æ—‹è½¬ç­‰åŸºç¡€ç¼–è¾‘åŠŸèƒ½
- **æ ‡ç­¾ç®¡ç†** - è‡ªåŠ¨æ ‡ç­¾ç”Ÿæˆå’Œæ‰‹åŠ¨æ ‡ç­¾ç®¡ç†

### ğŸ¤– AI æ™ºèƒ½åŠŸèƒ½
- **AI å›¾ç‰‡é—®ç­”** - åœ¨å›¾ç‰‡è¯¦æƒ…é¡µç›´æ¥ä¸ AI å¯¹è¯ï¼Œäº†è§£å›¾ç‰‡å†…å®¹
- **è‡ªåŠ¨æ ‡ç­¾ç”Ÿæˆ** - åŸºäºå›¾ç‰‡å†…å®¹è‡ªåŠ¨ç”Ÿæˆæ ‡ç­¾å’Œæè¿°
- **æ™ºèƒ½åˆ†ç±»** - AI è‡ªåŠ¨è¯†åˆ«åœºæ™¯ã€ç‰©ä½“ã€äººç‰©ç­‰

### ğŸ—ºï¸ åœ°å›¾è§†å›¾
- **åœ°ç†ä½ç½®å±•ç¤º** - åœ¨åœ°å›¾ä¸ŠæŸ¥çœ‹æ‰€æœ‰å¸¦ GPS çš„ç…§ç‰‡ä½ç½®
- **ä½ç½®ç­›é€‰** - æŒ‰åœ°ç†ä½ç½®ç­›é€‰å’Œæœç´¢ç…§ç‰‡
- **æ—…è¡Œè®°å½•** - è¿½æº¯æ‹æ‘„è½¨è¿¹å’Œåœ°ç‚¹

### ğŸ“ ç»„ç»‡ä¸ç®¡ç†
- **ç›¸å†Œç®¡ç†** - åˆ›å»ºå’Œç®¡ç†ä¸ªäººç›¸å†Œ
- **æ”¶è—åŠŸèƒ½** - å¿«é€Ÿæ”¶è—å–œæ¬¢çš„ç…§ç‰‡
- **å›æ”¶ç«™** - è¯¯åˆ æ¢å¤æœºåˆ¶

### ğŸ” ç”¨æˆ·ç³»ç»Ÿ
- **ç”¨æˆ·è®¤è¯** - åŸºäº NextAuth.js çš„å®‰å…¨è®¤è¯
- **æƒé™æ§åˆ¶** - æ¯ä¸ªç”¨æˆ·åªèƒ½è®¿é—®è‡ªå·±çš„å›¾ç‰‡
- **å¤šç”¨æˆ·æ”¯æŒ** - æ”¯æŒå¤šç”¨æˆ·åŒæ—¶ä½¿ç”¨

## ğŸ› ï¸ æŠ€æœ¯æ ˆ

### å‰ç«¯æŠ€æœ¯
- **æ¡†æ¶**: Next.js 14.2.18 (React 18.3.1)
- **è¯­è¨€**: TypeScript 5.6.3
- **æ ·å¼**: Tailwind CSS 3.4.18 + shadcn/ui
- **å›¾æ ‡**: Lucide React
- **çŠ¶æ€ç®¡ç†**: Zustand
- **è¡¨å•ç®¡ç†**: React Hook Form + Zod éªŒè¯

### åç«¯æŠ€æœ¯
- **è¿è¡Œæ—¶**: Node.js
- **API**: Next.js API Routes
- **ORM**: Prisma 5.22.0
- **æ•°æ®åº“**: MySQL 8.0+
- **è®¤è¯**: NextAuth.js 4.24.10

### å›¾ç‰‡å¤„ç†
- **å›¾åƒå¤„ç†**: Sharp (é«˜æ€§èƒ½å›¾åƒå¤„ç†)
- **EXIF è§£æ**: exifr (æå–ç…§ç‰‡å…ƒæ•°æ®)
- **å›¾åƒç¼–è¾‘**: CropperJS

### AI æœåŠ¡
- **å¤šæ¨¡å‹æ”¯æŒ**: DeepSeekã€ç™¾åº¦ AIã€è±†åŒ…ç­‰
- **å›¾ç‰‡ç†è§£**: æ”¯æŒ Vision æ¨¡å‹
- **æ–‡æœ¬ç”Ÿæˆ**: å¤šè½®å¯¹è¯æ”¯æŒ

### åœ°å›¾æœåŠ¡
- **åœ°å›¾åº“**: Leaflet + React-Leaflet
- **åœ°å›¾ç“¦ç‰‡**: OpenStreetMap (å…è´¹)

## ğŸš€ å¿«é€Ÿå¼€å§‹

### å‰ç½®è¦æ±‚

**æ–¹å¼ä¸€ï¼šDocker éƒ¨ç½²ï¼ˆæ¨èï¼‰**
- Docker 20.10+
- Docker Compose 2.0+

**æ–¹å¼äºŒï¼šæœ¬åœ°å¼€å‘**
- Node.js 18+
- MySQL 8.0+
- npm æˆ– yarn

### 1. å…‹éš†é¡¹ç›®

```bash
git clone https://github.com/BruceY-rgb/PictureManagementSystem.git
cd PictureManagementSystem
```

### 2. å®‰è£…ä¾èµ–

```bash
npm install
```

### 3. é…ç½®ç¯å¢ƒå˜é‡

å¤åˆ¶ç¯å¢ƒå˜é‡æ–‡ä»¶å¹¶é…ç½®ï¼š

```bash
cp .env.example .env
```

ç¼–è¾‘ `.env` æ–‡ä»¶ï¼š

```env
# æ•°æ®åº“é…ç½®
DATABASE_URL="mysql://root:password@localhost:3306/picture_management"

# NextAuth é…ç½®
NEXTAUTH_SECRET="your-secret-key-here"
# ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤ç”Ÿæˆå¯†é’¥:
# openssl rand -base64 32

NEXTAUTH_URL="http://localhost:3000"

# AI æœåŠ¡é…ç½® (å¯é€‰)
# DeepSeek (ç”¨äº AI é—®ç­”)
DEEPSEEK_API_KEY="your-deepseek-api-key"
DEEPSEEK_BASE_URL="https://api.deepseek.com"

# ç™¾åº¦ AI (ç”¨äºå›¾åƒè¯†åˆ«)
BAIDU_API_KEY="your-baidu-api-key"
BAIDU_SECRET_KEY="your-baidu-secret-key"

# è±†åŒ… AI (å¤‡é€‰æ–¹æ¡ˆ)
DOUBAO_API_KEY="your-doubao-api-key"
DOUBAO_BASE_URL="https://ark.cn-beijing.volces.com/api/v3"
DOUBAO_MODEL="doubao-1.5-vision-pro-250328"
```

### 4. åˆå§‹åŒ–æ•°æ®åº“

```bash
# åˆ›å»ºæ•°æ®åº“è¿ç§»
npx prisma migrate dev --name init

# ç”Ÿæˆ Prisma Client
npx prisma generate

# (å¯é€‰) æŸ¥çœ‹æ•°æ®åº“
npx prisma studio
```

### 5. å¯åŠ¨å¼€å‘æœåŠ¡å™¨

```bash
npm run dev
```

æ‰“å¼€ [http://localhost:3000](http://localhost:3000)

## ğŸ“ é¡¹ç›®ç»“æ„

```
src/
â”œâ”€â”€ app/                    # Next.js App Router
â”‚   â”œâ”€â”€ api/               # API è·¯ç”±
â”‚   â”‚   â”œâ”€â”€ auth/          # è®¤è¯ API
â”‚   â”‚   â”œâ”€â”€ images/        # å›¾ç‰‡ç›¸å…³ API
â”‚   â”‚   â”œâ”€â”€ search/        # æœç´¢ API
â”‚   â”‚   â””â”€â”€ tags/          # æ ‡ç­¾ API
â”‚   â”œâ”€â”€ gallery/           # å›¾ç‰‡ç”»å»Šé¡µé¢
â”‚   â”‚   â”œâ”€â”€ page.tsx       # æ‰€æœ‰å›¾ç‰‡
â”‚   â”‚   â””â”€â”€ [id]/page.tsx  # å›¾ç‰‡è¯¦æƒ…é¡µ
â”‚   â”œâ”€â”€ map/               # åœ°å›¾è§†å›¾é¡µé¢
â”‚   â”œâ”€â”€ albums/            # ç›¸å†Œé¡µé¢
â”‚   â”œâ”€â”€ favorites/         # æ”¶è—é¡µé¢
â”‚   â”œâ”€â”€ trash/             # å›æ”¶ç«™
â”‚   â”œâ”€â”€ search/            # æœç´¢é¡µé¢
â”‚   â”œâ”€â”€ upload/            # ä¸Šä¼ é¡µé¢
â”‚   â”œâ”€â”€ login/             # ç™»å½•é¡µé¢
â”‚   â””â”€â”€ register/          # æ³¨å†Œé¡µé¢
â”œâ”€â”€ components/            # å¯å¤ç”¨ç»„ä»¶
â”‚   â”œâ”€â”€ ui/               # shadcn/ui åŸºç¡€ç»„ä»¶
â”‚   â”œâ”€â”€ image/            # å›¾ç‰‡ç›¸å…³ç»„ä»¶
â”‚   â”œâ”€â”€ layout/           # å¸ƒå±€ç»„ä»¶
â”‚   â”œâ”€â”€ search/           # æœç´¢ç›¸å…³ç»„ä»¶
â”‚   â””â”€â”€ tags/             # æ ‡ç­¾ç›¸å…³ç»„ä»¶
â”œâ”€â”€ lib/                   # å·¥å…·å‡½æ•°åº“
â”‚   â”œâ”€â”€ ai/               # AI æœåŠ¡å°è£…
â”‚   â”‚   â”œâ”€â”€ deepseek.ts   # DeepSeek API
â”‚   â”‚   â”œâ”€â”€ doubao.ts     # è±†åŒ… API
â”‚   â”‚   â””â”€â”€ baidu.ts      # ç™¾åº¦ AI
â”‚   â”œâ”€â”€ auth.ts           # NextAuth é…ç½®
â”‚   â”œâ”€â”€ prisma.ts         # Prisma å®¢æˆ·ç«¯
â”‚   â”œâ”€â”€ image-utils.ts    # å›¾ç‰‡å¤„ç†å·¥å…·
â”‚   â””â”€â”€ utils.ts          # é€šç”¨å·¥å…·å‡½æ•°
â”œâ”€â”€ types/                 # TypeScript ç±»å‹å®šä¹‰
â”‚   â”œâ”€â”€ image.ts          # å›¾ç‰‡ç›¸å…³ç±»å‹
â”‚   â”œâ”€â”€ user.ts           # ç”¨æˆ·ç›¸å…³ç±»å‹
â”‚   â””â”€â”€ api.ts            # API ç›¸å…³ç±»å‹
â”œâ”€â”€ hooks/                 # è‡ªå®šä¹‰ React Hooks
â””â”€â”€ stores/                # Zustand çŠ¶æ€ç®¡ç†

prisma/
â”œâ”€â”€ schema.prisma          # æ•°æ®åº“ Schema
â””â”€â”€ migrations/            # æ•°æ®åº“è¿ç§»æ–‡ä»¶
```

## ğŸ“š ä¸»è¦åŠŸèƒ½è¯´æ˜

### å›¾ç‰‡ä¸Šä¼ 
- æ”¯æŒæ‹–æ‹½ä¸Šä¼ æˆ–ç‚¹å‡»ä¸Šä¼ 
- è‡ªåŠ¨æå– EXIF æ•°æ®ï¼ˆæ‹æ‘„æ—¶é—´ã€ç›¸æœºä¿¡æ¯ã€GPS ç­‰ï¼‰
- ç”Ÿæˆå¤šç§å°ºå¯¸ç¼©ç•¥å›¾ï¼ˆ150x150, 400x400, 800x800ï¼‰
- æ”¯æŒ JPGã€PNGã€GIFã€WebP æ ¼å¼

### å›¾ç‰‡ç”»å»Š
- å“åº”å¼ç½‘æ ¼å¸ƒå±€
- æ”¯æŒåˆ†é¡µå’Œæ— é™æ»šåŠ¨
- å®æ—¶æœç´¢å’Œç­›é€‰
- å¿«æ·æ“ä½œï¼šæ”¶è—ã€åˆ é™¤ã€ç¼–è¾‘

### AI å›¾ç‰‡é—®ç­”
- ä½äºå›¾ç‰‡è¯¦æƒ…é¡µå³ä¾§
- æ”¯æŒå¤šè½®å¯¹è¯
- åŸºäºå›¾ç‰‡ EXIF æ•°æ®å’Œ AI åˆ†æç»“æœå›ç­”
- å¿«æ·é—®é¢˜å»ºè®®

### åœ°å›¾è§†å›¾
- æ˜¾ç¤ºæ‰€æœ‰å¸¦ GPS çš„ç…§ç‰‡ä½ç½®
- ç‚¹å‡»æ ‡è®°æŸ¥çœ‹ç…§ç‰‡é¢„è§ˆ
- è‡ªåŠ¨é€‚åº”æ‰€æœ‰æ ‡è®°ä½ç½®
- ç»Ÿè®¡ä¿¡æ¯ï¼ˆæœ‰ä½ç½®/æ— ä½ç½®ç…§ç‰‡æ•°é‡ï¼‰

### æœç´¢åŠŸèƒ½
- å…³é”®è¯æœç´¢
- æŒ‰æ ‡ç­¾ç­›é€‰
- æŒ‰æ—¶é—´èŒƒå›´ç­›é€‰
- æŒ‰ä½ç½®ç­›é€‰ï¼ˆç»çº¬åº¦èŒƒå›´ï¼‰
- æŒ‰æ”¶è—çŠ¶æ€ç­›é€‰

## ğŸ”Œ API æ¥å£

### å›¾ç‰‡ç›¸å…³
- `GET /api/images` - è·å–å›¾ç‰‡åˆ—è¡¨
- `POST /api/images/upload` - ä¸Šä¼ å›¾ç‰‡
- `GET /api/images/[id]` - è·å–å›¾ç‰‡è¯¦æƒ…
- `PATCH /api/images/[id]` - æ›´æ–°å›¾ç‰‡ä¿¡æ¯
- `DELETE /api/images/[id]` - åˆ é™¤å›¾ç‰‡
- `GET /api/images/[id]/file` - è·å–å›¾ç‰‡æ–‡ä»¶
- `POST /api/images/[id]/tags` - æ·»åŠ æ ‡ç­¾
- `DELETE /api/images/[id]/tags` - åˆ é™¤æ ‡ç­¾
- `GET /api/images/locations` - è·å–æ‰€æœ‰å›¾ç‰‡ä½ç½®ï¼ˆåœ°å›¾ç”¨ï¼‰
- `POST /api/images/[id]/chat` - AI é—®ç­”

### æœç´¢
- `GET /api/images/search` - æœç´¢å›¾ç‰‡
- `GET /api/search/nl` - è‡ªç„¶è¯­è¨€æœç´¢


## ğŸ§ª å¯ç”¨è„šæœ¬

```bash
# å¼€å‘
npm run dev          # å¯åŠ¨å¼€å‘æœåŠ¡å™¨
npm run build        # æ„å»ºç”Ÿäº§ç‰ˆæœ¬
npm run start        # å¯åŠ¨ç”Ÿäº§æœåŠ¡å™¨

# ä»£ç è´¨é‡
npm run lint         # è¿è¡Œ ESLint
npm run lint:fix     # è‡ªåŠ¨ä¿®å¤ ESLint é”™è¯¯

# æ•°æ®åº“
npx prisma migrate dev        # åˆ›å»ºå¹¶åº”ç”¨è¿ç§»
npx prisma generate           # ç”Ÿæˆ Prisma Client
npx prisma studio             # æ‰“å¼€æ•°æ®åº“ç®¡ç†ç•Œé¢
npx prisma db seed            # è¿è¡Œç§å­æ•°æ®

# ç±»å‹æ£€æŸ¥
npx tsc --noEmit              # TypeScript ç±»å‹æ£€æŸ¥
```

## ğŸŒ éƒ¨ç½²

### Vercel éƒ¨ç½² (æ¨è)

1. Fork é¡¹ç›®åˆ° GitHub
2. åœ¨ Vercel ä¸­å¯¼å…¥é¡¹ç›®
3. é…ç½®ç¯å¢ƒå˜é‡
4. éƒ¨ç½²

### Docker éƒ¨ç½² (æ¨è)

ä½¿ç”¨ Docker Compose ä¸€é”®éƒ¨ç½²å®Œæ•´ç¯å¢ƒï¼ˆåŒ…å« MySQL æ•°æ®åº“ï¼‰ï¼š

```bash
# 1. å¤åˆ¶ç¯å¢ƒå˜é‡é…ç½®æ–‡ä»¶
cp .env.docker.example .env

# 2. ç¼–è¾‘ .env æ–‡ä»¶ï¼Œé…ç½®å¿…è¦çš„ç¯å¢ƒå˜é‡
# - MYSQL_ROOT_PASSWORD: æ•°æ®åº“å¯†ç 
# - NEXTAUTH_SECRET: è®¤è¯å¯†é’¥ï¼ˆç”Ÿäº§ç¯å¢ƒè¯·ä¿®æ”¹ï¼‰
# - DEEPSEEK_API_KEY: AI æœåŠ¡å¯†é’¥ï¼ˆå¯é€‰ï¼‰

# 3. æ„å»ºå¹¶å¯åŠ¨æ‰€æœ‰æœåŠ¡
docker-compose up -d --build

# 4. è¿è¡Œæ•°æ®åº“è¿ç§»
docker-compose run --rm migrate

# 5. è®¿é—®åº”ç”¨
# http://localhost:3000
```

#### Docker å¸¸ç”¨å‘½ä»¤

```bash
# æŸ¥çœ‹æœåŠ¡çŠ¶æ€
docker-compose ps

# æŸ¥çœ‹åº”ç”¨æ—¥å¿—
docker-compose logs -f app

# åœæ­¢æ‰€æœ‰æœåŠ¡
docker-compose down

# åœæ­¢å¹¶æ¸…é™¤æ•°æ®ï¼ˆè°¨æ…ä½¿ç”¨ï¼‰
docker-compose down -v

# é‡æ–°æ„å»º
docker-compose up -d --build
```

#### Docker æ–‡ä»¶è¯´æ˜

| æ–‡ä»¶ | è¯´æ˜ |
|------|------|
| `Dockerfile` | Next.js åº”ç”¨é•œåƒé…ç½® |
| `Dockerfile.migrate` | æ•°æ®åº“è¿ç§»é•œåƒé…ç½® |
| `docker-compose.yml` | Docker Compose ç¼–æ’é…ç½® |
| `.dockerignore` | Docker æ„å»ºå¿½ç•¥æ–‡ä»¶ |
| `.env.docker.example` | Docker ç¯å¢ƒå˜é‡ç¤ºä¾‹ |

æ›´å¤š Docker éƒ¨ç½²è¯¦æƒ…è¯·å‚é˜… [DOCKER.md](DOCKER.md)

### æ‰‹åŠ¨éƒ¨ç½²

1. æ„å»ºé¡¹ç›®ï¼š
```bash
npm run build
```

2. å¯åŠ¨ç”Ÿäº§æœåŠ¡å™¨ï¼š
```bash
npm run start
```

ç¡®ä¿ç”Ÿäº§ç¯å¢ƒå·²é…ç½®ï¼š
- MySQL æ•°æ®åº“
- æ‰€æœ‰ç¯å¢ƒå˜é‡
- HTTPSï¼ˆç”Ÿäº§ç¯å¢ƒï¼‰

## ğŸ¤ è´¡çŒ®æŒ‡å—

1. Fork æœ¬ä»“åº“
2. åˆ›å»ºç‰¹æ€§åˆ†æ”¯ (`git checkout -b feature/AmazingFeature`)
3. æäº¤æ›´æ”¹ (`git commit -m 'Add some AmazingFeature'`)
4. æ¨é€åˆ°åˆ†æ”¯ (`git push origin feature/AmazingFeature`)
5. å¼€å¯ Pull Request

### å¼€å‘è§„èŒƒ
- ä½¿ç”¨ TypeScript è¿›è¡Œç±»å‹å®‰å…¨å¼€å‘
- éµå¾ª ESLint é…ç½®
- ç»„ä»¶ä½¿ç”¨å‡½æ•°å¼ç»„ä»¶ + Hooks
- æäº¤ä¿¡æ¯ä½¿ç”¨çº¦å®šå¼æäº¤æ ¼å¼

## ğŸ“„ è®¸å¯è¯

æœ¬é¡¹ç›®ä¸ºæµ™æ±Ÿå¤§å­¦è¯¾ç¨‹ä½œä¸šé¡¹ç›®ï¼Œéµå¾ª MIT è®¸å¯è¯ã€‚è¯¦è§ [LICENSE](LICENSE) æ–‡ä»¶ã€‚

## ğŸ™ è‡´è°¢

- [Next.js](https://nextjs.org/) - React æ¡†æ¶
- [Prisma](https://www.prisma.io/) - æ•°æ®åº“ ORM
- [Tailwind CSS](https://tailwindcss.com/) - CSS æ¡†æ¶
- [shadcn/ui](https://ui.shadcn.com/) - UI ç»„ä»¶åº“
- [Sharp](https://sharp.pixelplumbing.com/) - å›¾åƒå¤„ç†
- [Leaflet](https://leafletjs.com/) - åœ°å›¾åº“

## ğŸ“ è”ç³»æˆ‘ä»¬

å¦‚æœ‰é—®é¢˜æˆ–å»ºè®®ï¼Œè¯·æäº¤ Issue æˆ–è”ç³»é¡¹ç›®ç»´æŠ¤è€…ã€‚

---

â­ å¦‚æœè¿™ä¸ªé¡¹ç›®å¯¹ä½ æœ‰å¸®åŠ©ï¼Œè¯·ç»™å®ƒä¸€ä¸ªæ˜Ÿæ ‡ï¼
